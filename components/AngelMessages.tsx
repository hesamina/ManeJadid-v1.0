
import React, { useState } from 'react';
import { Heart, X, Quote, Sparkles } from 'lucide-react';

const ANGEL_DATA = [
  { number: '000', title: 'یگانگی با مبدأ', meaning: 'شما در مرکز هستی و یگانگی با آفریدگار قرار دارید. چرخه جدیدی در حال آغاز است.' },
  { number: '111', title: 'تجلی افکار', meaning: 'دریچه تجلی باز شده است. افکار شما با سرعت نور به واقعیت تبدیل می‌شوند. مثبت بمانید.' },
  { number: '222', title: 'اعتماد و هماهنگی', meaning: 'همه چیز در حال درست شدن است. به نظم الهی اعتماد کنید و از نگرانی دست بکشید.' },
  { number: '333', title: 'حمایت اساتید', meaning: 'اساتید معنوی در کنار شما هستند. آن‌ها به دعاهای شما پاسخ می‌دهند و هدایتتان می‌کنند.' },
  { number: '444', title: 'حضور فرشتگان', meaning: 'هزاران فرشته در اطراف شما هستند و شما را غرق در عشق و حمایت خود کرده‌اند. نترسید.' },
  { number: '555', title: 'تغییرات بنیادین', meaning: 'تغییرات بزرگی در راه است. این تغییرات برای خیر برتر شماست، پس با آغوش باز پذیرا باشید.' },
  { number: '666', title: 'تعادل مادی و معنوی', meaning: 'افکار خود را از نگرانی‌های مادی رها کنید و بر عشق و معنویت تمرکز کنید تا تعادل بازگردد.' },
  { number: '777', title: 'معجزه و پاداش', meaning: 'فرشتگان شما را تشویق می‌کنند. شما در مسیر درست هستید و معجزات در حال رخ دادن هستند.' },
  { number: '888', title: 'فراوانی بیکران', meaning: 'دریچه‌های برکت و ثروت کائنات به روی شما باز شده است. جریان انرژی مالی در حال افزایش است.' },
  { number: '999', title: 'اتمام چرخه', meaning: 'یک مرحله مهم از زندگی شما به پایان رسیده است. وقت آن است که برای فصلی نورانی‌تر آماده شوید.' },
  { number: '1111', title: 'بیداری و آگاهی', meaning: 'اتصال شما به منبع الهی برقرار شده است. این یک بیداری معنوی بزرگ است؛ به شهود خود گوش دهید.' },
  { number: '1212', title: 'هم‌سویی با کائنات', meaning: 'کائنات در حال تایید مسیر شماست. افکار مثبت خود را حفظ کنید تا به اهدافتان برسید.' },
  { number: '2222', title: 'ایمان مطلق', meaning: 'ایمان داشته باشید که همه چیز در بهترین زمان ممکن رخ می‌دهد. صبور باشید و در آرامش بمانید.' },
  { number: '3333', title: 'خلاقیت الهی', meaning: 'شما کانالی برای خلاقیت الهی هستید. ایده‌های خود را دنبال کنید، فرشتگان حامی شما هستند.' },
  { number: '4444', title: 'ثبات و امنیت', meaning: 'پایه‌های زندگی شما در حال محکم شدن است. شما کاملاً محافظت شده و در امنیت هستید.' },
  { number: '5555', title: 'آزادی و رهایی', meaning: 'زنجیرهای گذشته در حال باز شدن هستند. آزادی روح خود را جشن بگیرید و پرواز کنید.' },
  { number: '6666', title: 'هماهنگی درونی', meaning: 'زمان آن است که با خودتان مهربان‌تر باشید. صلح درونی، دنیای بیرون شما را تغییر می‌دهد.' },
  { number: '7777', title: 'روشنگری', meaning: 'نور حقیقت بر قلب شما تابیده است. شما به درک عمیقی از هستی دست یافته‌اید.' },
  { number: '8888', title: 'برکت ابدی', meaning: 'پاداش تمام سختی‌ها در حال رسیدن است. ثروت و عشق به طور همزمان وارد زندگی‌تان می‌شود.' },
  { number: '9999', title: 'خدمت به زمین', meaning: 'ماموریت شما در این چرخه به کمال رسیده است. اکنون زمان درخشش و راهنمایی دیگران است.' },
  { number: '1010', title: 'شروع مسیر جدید', meaning: 'خداوند مستقیماً با شما صحبت می‌کند. وقت آن است که گام‌های جسورانه‌ای برای رویاهایتان بردارید.' },
  { number: '1313', title: 'قدرت درون', meaning: 'ترس‌ها را رها کنید. قدرت واقعی از درون شما می‌جوشد. به توانایی‌های خود شک نکنید.' },
  { number: '1414', title: 'هدایت فرشتگان', meaning: 'فرشتگان نگهبان در حال چیدن قطعات پازل زندگی شما هستند. به نشانه‌ها دقت کنید.' },
  { number: '1515', title: 'تصمیمات قلبی', meaning: 'زمان آن رسیده که بر اساس ندای قلبتان عمل کنید. عشق بهترین راهنمای شماست.' },
  { number: '1616', title: 'پاکسازی انرژی', meaning: 'انرژی‌های قدیمی را رها کنید تا فضا برای معجزات جدید باز شود. شما در حال نوسازی هستید.' },
  { number: '1717', title: 'مسیر درست', meaning: 'شما دقیقاً در جایی هستید که باید باشید. به انتخاب‌های خود افتخار کنید و ادامه دهید.' },
  { number: '1818', title: 'جریان ثروت', meaning: 'محدودیت‌های ذهنی درباره فراوانی را دور بریزید. ثروت در حال سرازیر شدن به سمت شماست.' },
  { number: '1919', title: 'خدمت آگاهانه', meaning: 'شما نوری برای دیگران هستید. با به اشتراک گذاشتن آگاهی خود، جهان را زیباتر می‌کنید.' },
  { number: '2020', title: 'قدرت ایمان', meaning: 'ناممکن‌ها در حال ممکن شدن هستند. قدرت اراده و ایمان شما کوه‌ها را جابجا می‌کند.' },
  { number: '2121', title: 'آرامش ذهن', meaning: 'ذهن خود را آرام کنید. در سکوت است که بزرگترین پاسخ‌ها به سراغتان می‌آیند.' },
  { number: '2323', title: 'همکاران معنوی', meaning: 'شما در این مسیر تنها نیستید. تمام کائنات در حال همکاری برای موفقیت شماست.' },
  { number: '1122', title: 'گام‌های آگاهانه', meaning: 'هر قدم کوچکی که با آگاهی برمی‌دارید، شما را به هدفتان نزدیک‌تر می‌کند.' },
  { number: '1133', title: 'رهبری معنوی', meaning: 'شما برای رهبری و الهام‌بخشی آفریده شده‌اید. صدای خود را به گوش جهان برسانید.' },
  { number: '1144', title: 'تلاش با پشتوانه', meaning: 'تلاش‌های فیزیکی شما با حمایت‌های ماورایی همراه شده است. پیروزی قطعی است.' },
  { number: '1155', title: 'تحولات سریع', meaning: 'اتفاقات با سرعتی غیرمنتظره به نفع شما تغییر می‌کنند. آماده سورپرایزهای الهی باشید.' },
  { number: '1234', title: 'پیشرفت تدریجی', meaning: 'کائنات در حال نظم دادن به زندگی شماست. پله پله به سمت اوج حرکت می‌کنید.' },
  { number: '0101', title: 'ارتباط مستقیم', meaning: 'اتصال شما به مبدأ هستی در قوی‌ترین حالت ممکن است. هر چه بخواهید مستجاب می‌شود.' },
  { number: '121', title: 'تمرکز بر هدف', meaning: 'پراکندگی ذهن را جمع کنید. با تمرکز بر یک نقطه، معجزه رخ می‌دهد.' },
  { number: '212', title: 'تعادل ارتعاش', meaning: 'بین دنیای درون و بیرون تعادل برقرار کنید تا ثبات به زندگی‌تان بازگردد.' },
  { number: '313', title: 'ارتباط معنوی', meaning: 'دعاهای شما در حال شنیده شدن است. پاسخ‌ها به زودی ظاهر می‌شوند.' },
  { number: '414', title: 'امنیت الهی', meaning: 'دیواری از نور در اطراف شماست. هیچ انرژی منفی نمی‌تواند به حریم شما نفوذ کند.' },
  { number: '515', title: 'خوش‌بینی', meaning: 'تغییرات مثبت در راه است. با لبخند به استقبال آینده بروید.' },
  { number: '616', title: 'تمرکز بر خانه', meaning: 'زمان آن است که عشق و آرامش را در محیط زندگی و خانواده خود جاری کنید.' },
  { number: '717', title: 'پاداش تلاش', meaning: 'کائنات از تلاش‌های شما آگاه است. پاداشی بزرگ در انتظار صبر شماست.' },
  { number: '818', title: 'استقلال مالی', meaning: 'دوران وابستگی تمام شده است. قدرت خلق ثروت در دستان شماست.' },
  { number: '919', title: 'طلوع آگاهی', meaning: 'خورشیدِ جدیدی در زندگی شما در حال طلوع است. تاریکی تمام شد.' },
  { number: '0202', title: 'شراکت الهی', meaning: 'نیروهای غیبی برای یاری شما بسیج شده‌اند. اتحاد شما با کائنات در حال تقویت است.' },
  { number: '0303', title: 'انبساط روح', meaning: 'روح شما در حال انبساط است. ظرفیت‌های جدیدی برای دریافت نور پیدا کرده‌اید.' },
  { number: '0404', title: 'صلح بلورین', meaning: 'آشفتگی‌ها در حال رخت بربستن هستند. ذهن شما به آرامشی بلورین نزدیک می‌شود.' },
  { number: '0505', title: 'بیداری بزرگ', meaning: 'ترس از ناشناخته‌ها را کنار بگذارید. سفری که پیش رو دارید، بیداری بزرگی به همراه دارد.' },
  { number: '0606', title: 'عشق بی‌قید و شرط', meaning: 'زمان آن است که عشق را بدون انتظار جاری کنید. این ارتعاش، تمام درها را باز می‌کند.' },
  { number: '0707', title: 'نجوای فرشتگان', meaning: 'به اولین حسی که به قلبتان می‌آید اعتماد کنید. فرشتگان از طریق احساس با شما حرف می‌زنند.' },
  { number: '0808', title: 'اقتدار قلبی', meaning: 'شما مقتدرتر از آن هستید که تصور می‌کنید. افسار زندگی را با عشق در دست بگیرید.' },
  { number: '0909', title: 'نورِ جهانی', meaning: 'شما برای کاری بزرگتر از نیازهای شخصی انتخاب شده‌اید. به جهان نور ببخشید.' },
  { number: '1221', title: 'آینۀ درون', meaning: 'آنچه در بیرون می‌بینید، آینه‌ای از باورهای شماست. آینه را با افکار زیبا پاک کنید.' },
  { number: '1331', title: 'تخریب موانع', meaning: 'موانع موقتی هستند. اراده شما راهی خواهد ساخت که دیگران آن را بن‌بست می‌بینند.' },
  { number: '1441', title: 'سپر نوری', meaning: 'در هر قدم، سپری از نور شما را در بر گرفته است. با اطمینان کامل گام بردارید.' },
  { number: '1551', title: 'ندای شهود', meaning: 'شما در آستانه یک تصمیم بزرگ هستید. قلبتان از پیش پاسخ را می‌داند.' },
  { number: '234', title: 'پلکان رشد', meaning: 'عجله نکنید. هر پله برای رشد شما ضروری است. صبور باشید و صعود کنید.' },
  { number: '345', title: 'ریتم کائنات', meaning: 'زندگی شما در حال هماهنگ شدن با ریتم طبیعی و جهانی هستی است.' },
  { number: '456', title: 'تامین الهی', meaning: 'در حالی که به جلو حرکت می‌کنید، تمام نیازهای مادی و معنوی شما تامین می‌شود.' },
  { number: '567', title: 'شتاب آگاهی', meaning: 'سرعت رشد شما در حال افزایش است. خود را آماده اوج گرفتن در آگاهی کنید.' },
  { number: '678', title: 'وفور مستمر', meaning: 'جریان برکت در زندگی شما قطع نمی‌شود، به شرط آنکه بخشنده و شاکر بمانید.' },
  { number: '789', title: 'پروازِ نهایی', meaning: 'شما آماده هستید تا از پیله خود خارج شوید و به پهنای آسمانِ آگاهی پرواز کنید.' }
];

const QUOTES_POOL = [
  "هر چه در جستن آنی، آنی.",
  "صبر تلخ است ولیکن برِ شیرین دارد.",
  "عشق همان مغز است و عالم پوست.",
  "در ناامیدی بسی امید است، پایان شب سیه سپید است.",
  "از دی که گذشت هیچ از او یاد مکن، فردا که نیامده‌ست فریاد مکن.",
  "بیرون ز تو نیست هر چه در عالم هست، در خود بطلب هر آنچه خواهی که تویی.",
  "هیچ چبزی در جهان زیباتر از یک شروع دوباره نیست.",
  "تو جهانی هستی در کالبد یک انسان.",
  "دلا نزد کسی بنشین که او از دل خبر دارد.",
  "آسمان بار امانت نتوانست کشید، قرعه کار به نام من دیوانه زدند.",
  "خنده باید زد به ریش روزگار، ورنه دیر یا زود پیرت می‌کند.",
  "ما ز یاران چشم یاری داشتیم، خود غلط بود آنچه می‌پنداشتیم.",
  "رسد آدمی به جایی که به جز خدا نبیند.",
  "دنیا همه هیچ و اهل دنیا همه هیچ.",
  "اندر دل من درون و بیرون همه اوست.",
  "درد را از هر طرف بخوانی درد است، اما درمان را باید ساخت.",
  "هر لحظه که تسلیمم در کارگه تقدیر، آرام‌تر از آهو بی‌باک‌تر از شیرم.",
  "آنچه لایق توست، در راه است. فقط صبور باش.",
  "فرشته‌ها زمانی می‌آیند که فضای خالی برایشان باز کنی.",
  "سکوت، زبانِ فرشتگان است.",
  "تو قطره‌ای در اقیانوس نیستی، تو کل اقیانوس در یک قطره‌ای.",
  "تنها زمانی که داری، اکنون است؛ آن را با حسرت از دست نده.",
  "قلب تو قطب‌نمای الهی توست، به صدایش اعتماد کن.",
  "هر اتفاقی که می‌افتد، برای بیداری توست.",
  "تو نوری هستی که بر تماشای خود آمده‌ای.",
  "جهان بازتابی از باورهای عمیق توست، ارتعاشت را تغییر بده.",
  "در سکوت است که پاسخ‌ها شنیده می‌شوند.",
  "هیچ مسیری بن‌بست نیست، مگر آنکه در ذهنت آن را بسازی.",
  "عشق تنها زبانی است که نیاز به ترجمه ندارد.",
  "تو برای رنج کشیدن نیامده‌ای، تو برای تجربه شکوه خلقت آمده‌ای.",
  "ببخش تا فضا برای دریافت معجزات جدید باز شود.",
  "منِ برتر تو همیشه بیدار است، فقط کافیست آرام شوی.",
  "هر طلوع، فرصتی برای تولدی دوباره است.",
  "خداوند در لبخندی که به دیگران می‌بخشی، حضور دارد.",
  "تو معمار سرنوشت خویشی، با آجرِ آگاهی خانه‌ات را بساز.",
  "تسلیم شدن به معنای ضعف نیست، بلکه هماهنگی با جریان کائنات است.",
  "تمام آنچه نیاز داری، همین حالا درون توست.",
  "به جای آنکه نگران آینده باشی، در اکنون ریشه بدوان.",
  "نور همیشه از میان زخم‌ها وارد می‌شود.",
  "تو شاهکار خلقت هستی، خودت را دست‌کم نگیر.",
  "برکت در شکرگزاری نهفته است.",
  "هر که را اسرار حق آموختند، مهر کردند و دهانش دوختند.",
  "با خودت مهربان باش، تو تنها همراه همیشگی خودت هستی.",
  "ایمان یعنی دیدن نادیدنی‌ها و باور کردن ناممکن‌ها.",
  "صدای قلب تو، زمزمه‌ی خدا در زمین است.",
  "جهان به تو آن چیزی را می‌دهد که هستی، نه آن چیزی که می‌خواهی.",
  "آرامش، نتیجه‌ی رها کردن قضاوت‌هاست.",
  "تو به دنیا نیامده‌ای که معمولی باشی، تو برای درخشش آمده‌ای.",
  "در تاریک‌ترین شب‌ها، ستاره‌ها درخشان‌ترند.",
  "عشق، درمانِ تمام دردهای روح است.",
  "بگذار زندگی از طریق تو جریان یابد، نه علیه تو.",
  "هر انسانی که ملاقات می‌کنی، آیینه‌ای برای شناخت خودت است.",
  "فراوانی، وضعیتی ذهنی است، نه موجودی حساب بانکی.",
  "تو نوری، تو عشقی، تو جاودانه‌ای.",
  "گذشته را در خاک دفن کن و اجازه بده شکوفه‌های آینده رشد کنند.",
  "شجاعت یعنی با وجود ترس، قدم بعدی را برداشتن.",
  "کائنات هرگز اشتباه نمی‌کند.",
  "تو برای بیدار کردنِ جهان آمده‌ای، نه برای خوابیدن در آن.",
  "سادگی، نهایتِ پیچیدگی و کمال است.",
  "قدرت واقعی در سکوت نهفته است، نه در فریاد.",
  "تو همان تغییری باش که می‌خواهی در جهان ببینی.",
  "هر چه بیشتر رها کنی، بیشتر به دست می‌آوری.",
  "خوشبختی، سفری است که از درون شروع می‌شود.",
  "به یاد داشته باش که تو هرگز تنها نیستی.",
  "فرشتگان با بال‌های ایمان بر شانه‌هایت نشسته‌اند.",
  "ذهن خود را به خدمتِ قلب درآور.",
  "زندگی یک بازی است، یاد بگیر که با لذت بازی کنی.",
  "هیچ چیز تصادفی نیست، هر دیداری پیامی دارد.",
  "بیداری یعنی دیدنِ خدا در تمامِ ذرات.",
  "بهترین دعا، شکرگزاری در لحظه‌ی حال است.",
  "تو لایقِ تمامِ خوبی‌های جهان هستی، فقط پذیرا باش.",
  "رویاهایت را جدی بگیر، آن‌ها نقشه‌ی راهِ تو هستند.",
  "پذیرش، آغازِ تحول است.",
  "هرگز برای شروعِ دوباره دیر نیست.",
  "نورِ تو می‌تواند جهان را روشن کند، اجازه بده بدرخشد.",
  "در میان هر دشواری، فرصتی نهفته است.",
  "تو آزاد آفریده شده‌ای، زنجیرهای ذهنی‌ات را پاره کن.",
  "عشق، تنها واقعیتی است که باقی می‌ماند.",
  "با طبیعت پیوند بخور تا آرامشِ ابدی را بیابی.",
  "تو موسیقیِ کائنات هستی، نت‌هایت را با عشق بنواز.",
  "ای دل نپرانی که تو را بال و پری هست...",
  "هر لحظه را چنان زندگی کن که گویی آخرین لحظه است.",
  "تو برای برتری نیامده‌ای، برای یگانگی آمده‌ای.",
  "خداوند نزدیک‌تر از رگِ گردن است، در قلبت او را بجوی.",
  "سکوت، غنی‌ترین نوعِ گفتگوست.",
  "بیداری، درکِ این است که تو از پیش کامل بوده‌ای.",
  "هر گرهی که در زندگی می‌خورد، راهی برای صعودِ توست.",
  "تو همسفرِ ستارگانی، زمینی فکر نکن.",
  "عشق، پلی است میان تو و همه چیز.",
  "به یاد داشته باش که همیشه راهی هست.",
  "تو نورِ چشمانِ کائناتی.",
  "هر دم که فرو می‌رود ممدّ حیات است...",
  "آرام باش و بدان که من خدا هستم.",
  "تو معجزه‌ای هستی که منتظرش بودی.",
  "به خودت ایمان داشته باش، کائنات به تو ایمان دارد.",
  "شکوهِ تو در سادگیِ حضورِ توست.",
  "بگذار عشق، تنها راهنمای تو باشد.",
  "تو در محاصره‌ی فرشتگان و نور هستی.",
  "فردا روزِ دیگری نیست، فردا همین لحظه است که می‌سازی.",
  "تو بی‌پایانی، چون از منبعِ بی‌پایان برخاسته‌ای.",
  "لبخند بزن، تو آیینه‌یِ جمالِ الهی هستی.",
  "هر چه در عالم هست، در تو هست؛ از خود بطلب.",
  "تو بیداری، فقط باید به یاد بیاوری.",
  "آرامشِ تو، بزرگترین هدیه‌ی تو به جهان است.",
  "در هر سقوط، بال‌هایت را برای پرواز پیدا کن.",
  "تو برای درخشیدن آفریده شده‌ای.",
  "ایمان، بالِ پروازِ توست.",
  "در هر ذره، نوری از حقیقت نهفته است.",
  "تو فراتر از افکارت هستی، تو همان سکوتِ ناظری.",
  "برکت، در هر لحظه جاری است، فقط پذیرا باش.",
  "قلبت را برای معجزات باز نگه دار.",
  "نورِ درونِ تو، فانوسِ دریاییِ جهان است.",
  "تو برایِ شادمانی آفریده شده‌ای، نه برایِ رنج.",
  "هر تپش، فرصتی برای تولدی دوباره است.",
  "صدایِ قلبت، دقیق‌ترین قطب‌نمایِ جهان است.",
  "تو از پیش تمامِ آنچه نیاز داری را داری.",
  "سکوت، زبانی است که کائنات با آن با تو حرف می‌زند.",
  "عشق، تنها پلی است که به ابدیت می‌رسد.",
  "تو نوری هستی که از منبعِ بی‌پایان می‌تابد.",
  "هر اتفاق، درسی است که روحِ تو به آن نیاز داشت.",
  "برکت، در کوچکترین جزییاتِ زندگی نهفته است.",
  "تو ارزشمند هستی، فقط به خاطرِ اینکه هستی.",
  "ایمان، دیدنِ نادیدنی‌ها با چشمِ دل است.",
  "قلبِ تو، جایگاهِ امنِ پروردگار است.",
  "تو برایِ درخشیدن آمده‌ای، نه برایِ پنهان شدن.",
  "آرامش، پاداشِ رها کردنِ کنترل است.",
  "تو همواره در آغوشِ گرمِ کائنات هستی.",
  "زندگی، جریانی از معجزاتِ بی‌پایان است."
];

const AngelMessages: React.FC = () => {
  const [isOpen, setIsOpen] = useState(false);
  const [currentMsg, setCurrentMsg] = useState(ANGEL_DATA[0]);
  const [currentQuote, setCurrentQuote] = useState(QUOTES_POOL[0]);

  // منطق هوشمند برای جلوگیری از تکرار با استفاده از تاریخچه در localStorage
  const getNextRandomIndices = () => {
    const historyJson = localStorage.getItem('mj-angel-history-v2');
    let history = historyJson ? JSON.parse(historyJson) : { seenNumbers: [], seenQuotes: [] };

    // انتخاب عدد فرشته غیرتکراری
    let availableNumbers = ANGEL_DATA.map((_, i) => i).filter(i => !history.seenNumbers.includes(i));
    if (availableNumbers.length === 0) {
      history.seenNumbers = []; // ریست تاریخچه وقتی همه دیده شدند
      availableNumbers = ANGEL_DATA.map((_, i) => i);
    }
    const numIdx = availableNumbers[Math.floor(Math.random() * availableNumbers.length)];

    // انتخاب جمله غیرتکراری
    let availableQuotes = QUOTES_POOL.map((_, i) => i).filter(i => !history.seenQuotes.includes(i));
    if (availableQuotes.length === 0) {
      history.seenQuotes = []; // ریست تاریخچه وقتی همه دیده شدند
      availableQuotes = QUOTES_POOL.map((_, i) => i);
    }
    const quoteIdx = availableQuotes[Math.floor(Math.random() * availableQuotes.length)];

    // آپدیت تاریخچه
    history.seenNumbers.push(numIdx);
    history.seenQuotes.push(quoteIdx);
    
    // محدود کردن تاریخچه برای بهینه‌سازی (مثلاً ۶۰ تای آخر)
    if (history.seenNumbers.length > 60) history.seenNumbers.shift();
    if (history.seenQuotes.length > 100) history.seenQuotes.shift();
    
    localStorage.setItem('mj-angel-history-v2', JSON.stringify(history));

    return { numIdx, quoteIdx };
  };

  const openLetter = () => {
    if (!isOpen) {
      const { numIdx, quoteIdx } = getNextRandomIndices();
      setCurrentMsg(ANGEL_DATA[numIdx]);
      setCurrentQuote(QUOTES_POOL[quoteIdx]);
      setIsOpen(true);
    }
  };

  return (
    <div className="flex flex-col items-center justify-center h-full animate-in fade-in duration-1000 p-4 overflow-hidden select-none">
      <div className="text-center mb-10">
        <h2 className="text-2xl font-black text-slate-800 dark:text-white">پیام فرشتگان</h2>
        <p className="text-[9px] font-black text-slate-400 uppercase tracking-[0.3em] mt-1">فرکانس روح را لمس کن</p>
      </div>

      <div className="relative group cursor-pointer" onClick={openLetter}>
        <div className={`relative w-60 h-44 bg-amber-50 dark:bg-amber-900/10 rounded-3xl shadow-xl transition-all duration-700 ${isOpen ? 'scale-110 rotate-3 opacity-0 pointer-events-none' : 'animate-float hover:scale-105'}`}>
          <div className="absolute inset-0 bg-white/40 dark:bg-slate-900/40 rounded-3xl overflow-hidden border border-amber-200/20">
             <div className="absolute top-0 left-0 w-full h-full bg-amber-100/10 clip-path-envelope-back"></div>
             <div className="absolute bottom-0 left-0 w-full h-2/3 bg-white/60 clip-path-envelope-front shadow-inner"></div>
             <div className="absolute top-0 left-0 w-full h-1/2 bg-amber-200/50 clip-path-envelope-flap"></div>
          </div>
          <div className="absolute inset-0 flex items-center justify-center">
             <div className="w-14 h-14 bg-rose-500 rounded-full flex items-center justify-center shadow-lg animate-pulse border-4 border-white dark:border-slate-900">
                <Heart className="text-white fill-white w-6 h-6" />
             </div>
          </div>
        </div>

        {isOpen && (
          <div className="fixed inset-0 z-[100] flex items-center justify-center p-6 bg-slate-950/40 backdrop-blur-xl animate-in zoom-in">
            <div className="bg-white dark:bg-slate-900 w-full max-w-sm rounded-[3.5rem] p-8 shadow-2xl border-4 border-amber-50 relative overflow-hidden max-h-[90vh] flex flex-col items-center">
               <Sparkles className="absolute -right-6 -top-6 w-32 h-32 text-amber-500 opacity-10" />
               <button onClick={(e) => {e.stopPropagation(); setIsOpen(false);}} className="absolute top-6 left-6 p-2 bg-slate-50 dark:bg-slate-800 rounded-full active:scale-90 transition-all"><X size={20} className="text-slate-400" /></button>
               
               <div className="text-center space-y-6 pt-4 w-full overflow-y-auto no-scrollbar">
                  <div className="space-y-1">
                    <div className="inline-block px-8 py-4 bg-amber-50 dark:bg-amber-950/40 rounded-[2.5rem] text-amber-600 font-black text-5xl tabular-nums shadow-inner border border-amber-100">
                      {currentMsg.number}
                    </div>
                    <h3 className="text-xl font-black text-slate-900 dark:text-white mt-4">{currentMsg.title}</h3>
                  </div>
                  
                  <div className="space-y-4 text-right">
                    <p className="text-[13px] font-bold text-slate-600 dark:text-slate-300 leading-relaxed px-2">
                      {currentMsg.meaning}
                    </p>
                    
                    <div className="bg-indigo-50 dark:bg-indigo-950/40 p-5 rounded-[2rem] text-right border border-indigo-100 relative mt-4">
                      <Quote className="absolute -left-1 -top-1 w-10 h-10 opacity-5 text-indigo-900 rotate-180" />
                      <p className="text-xs font-black text-indigo-900 dark:text-indigo-200 leading-relaxed italic">
                        « {currentQuote} »
                      </p>
                    </div>
                  </div>

                  <button onClick={(e) => {e.stopPropagation(); setIsOpen(false);}} className="w-full py-5 bg-slate-950 dark:bg-white dark:text-slate-950 text-white rounded-[1.8rem] font-black text-sm shadow-xl active:scale-95 transition-all mt-4">در ارتعاش بمان</button>
               </div>
            </div>
          </div>
        )}
      </div>

      {!isOpen && (
        <p className="mt-12 text-[10px] font-black text-slate-400 uppercase tracking-widest animate-pulse">لمس برای باز کردن پاکت فرکانس</p>
      )}

      <style>{`
        .clip-path-envelope-back { clip-path: polygon(0 0, 100% 0, 100% 100%, 0% 100%); }
        .clip-path-envelope-front { clip-path: polygon(0 40%, 50% 100%, 100% 40%, 100% 100%, 0 100%); }
        .clip-path-envelope-flap { clip-path: polygon(0 0, 50% 100%, 100% 0); }
        @keyframes float-angel { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
        .animate-float { animation: float-angel 6s infinite ease-in-out; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
      `}</style>
    </div>
  );
};

export default AngelMessages;
